# Contributor: Jens Pranaitis <jens@chaox.net>
# Contributor: Francesco Piccinno <stack.box@gmail.com>

pkgname=nikto
pkgver=2.1.0
pkgrel=1
pkgdesc='Nikto is a web server scanner which performs comprehensive tests against web servers for multiple items'
url='http://www.cirt.net/code/nikto.shtml'
updateurl='http://www.cirt.net/code/nikto.shtml=>nikto-'
license='GPL'
arch=('any')
groups=('archpwn' 'archpwn-scanners' 'archpwn-www')
depends=('perl' 'openssl' 'perl-net-ssleay')
source=(http://www.cirt.net/nikto/$pkgname-$pkgver.tar.bz2)
md5sums=('ce971262e14f5ac1ff634b86366bdaa8')

build() {
  cd $srcdir/$pkgname-$pkgver

  perl nikto.pl -update

  install -d $pkgdir/usr/bin
  install -d $pkgdir/usr/share/$pkgname/
  install -d $pkgdir/usr/share/doc/$pkgname/

  install -Dm644 docs/nikto.dtd $pkgdir/usr/share/doc/$pkgname/nikto.dtd || return 1
  install -Dm644 docs/nikto_manual.html $pkgdir/usr/share/doc/$pkgname/nikto_manual.html || return 1

  gzip docs/nikto.1 || return 1
  install -Dm644 docs/nikto.1.gz $pkgdir/usr/share/man/man1/nikto.1.gz || return 1

  for dir in plugins templates; do
    cp -r $dir $pkgdir/usr/share/$pkgname/ || return 1
  done

  install -Dm644 nikto.conf $pkgdir/usr/share/$pkgname/ || return 1
  install -Dm755 nikto.pl $pkgdir/usr/share/$pkgname/ || return 1

  cat > $pkgdir/usr/bin/nikto << EOF
#!/bin/sh
cd /usr/share/$pkgname/
perl nikto.pl \$*
EOF
  chmod 0755 $pkgdir/usr/bin/nikto

	echo "Don't forget to update the database first with:"
	echo "nikto -update"
}
