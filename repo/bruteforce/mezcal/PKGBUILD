# Contributor: Francesco Piccinno <stack.box@gmail.com>

pkgname=mezcal
pkgver=1.1
pkgrel=1
pkgdesc="Mezcal is an HTTP/HTTPS bruteforcing tool allowing the crafting of requests and insertion of dynamic variables on-the-fly."
url="http://www.0x90.org/releases/mezcal/"
groups=('archpwn' 'archpwn-database')
arch=('any')
license=('GPL' 'BSD')
depends=('mono' 'wxdotnet')
makedepends=('nant')
source=(http://www.0x90.org/releases/mezcal/Mezcal-${pkgver}-Source.tar.gz
        http://www.0x90.org/releases/mezcal/Mezcal-${pkgver}-Linux.tar.gz
        http://www.0x90.org/releases/absinthe/Absinthe-1.4.1-Linux.tar.gz)
md5sums=('06dffc11f258b3ea73fc930afa62ded3'
         '83714a9846b666ffac9da383dffa7d34'
         '09cf527031ff7487bcab6d31ecfad0c1')

build() {
  cd "$srcdir/Mezcal"

  ln -s /usr/lib/mono/wx-dotnet/wx.NET.dll .

  cp "$srcdir/Mezcal-$pkgver-Linux/Org.Mentalis.Security.dll" .
  cp "$srcdir/Absinthe-1.4.1-Linux/LiquorCabinet.Shared.dll" .

  nant || return 1

  install -d $pkgdir/usr/bin
  install -Dm644 README $pkgdir/usr/share/$pkgname/README

  for file in Mezcal.exe LiquorCabinet.Shared.dll Org.Mentalis.Security.dll; do
    install -Dm755 $file $pkgdir/usr/share/$pkgname/$file
  done

  cat > $pkgdir/usr/bin/$pkgname << EOF
#!/bin/sh
mono /usr/share/$pkgname/Mezcal.exe
EOF
  chmod 0755 $pkgdir/usr/bin/$pkgname
}

# vim:set ts=2 sw=2 et:
